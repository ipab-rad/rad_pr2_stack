<launch>

  <arg name="db" default="false" />
  <arg name="debug" default="false" />

  <include file="$(find pr2_moveit_config)/launch/planning_context.launch">
    <arg name="load_robot_description" value="true"/>
  </include>


  <include file="$(find pr2_moveit_config)/launch/move_group.launch">
    <arg name="allow_trajectory_execution" value="true"/>
    <arg name="info" value="true"/>
    <arg name="debug" value="$(arg debug)"/>
  </include>

  <include file="$(find pr2_teleop)/launch/teleop_keyboard.launch"/>


  <include file="$(find pr2_py)/launch/moveit_rviz.launch">
    <arg name="config" value="true"/>
    <arg name="debug" value="$(arg debug)"/>
  </include>

  <include file="$(find pr2_py)/launch/pr2_gazebo.launch"/>



  <node name="octomap_server" pkg="octomap_server" type="octomap_server_node">
    <param name="vis_min_z" value="0.08" />
    <!-- <param name="vis_max_z" value="2.0" /> -->
    <!-- fixed map frame (set to 'map' if SLAM or localization running!) -->
    <!-- Octomap uses odom_combined, but map is doing SLAM -->
    <param name="frame_id" type="string" value="odom_combined" />

    <param name="resolution" value="0.025" /> 

    <!-- maximum range to integrate (speedup, accuracy) -->
    <param name="max_sensor_range" value="5.0" />

   <param name="sensor_model_hit" value= "0.8" />
   <param name="sensor_model_miss" value= "0.31" />
   <param name="sensor_model_min" value= "0.12" />
   <param name="sensor_model_max" value= "0.95" />


   <param name="pointcloud_min_z" value="-0.03" />
   <param name="pointcloud_max_z" value="2.0" />
   <param name="occupancy_min_z" value="0.05" />
   <param name="occupancy_max_z" value="2.0" />

   <param name="filter_speckles" value="True" />
   <param name="ground_filter/distance" value="0.10" />
   <param name="ground_filter/angle" value="0.15" />
   <param name="ground_filter/plane_distance" value="0.07" />

   <param name="min_x_size" value="25.0" />
   <param name="min_y_size" value="25.0" />

   <!-- Set to true only when building static maps -->
   <param name="latch" value="false" />

    <!-- Save octomap here on destruction of the server -->
    <!--param name="save_directory" value="$(optenv OCTOMAP_SAVE_DIR ./)" /-->

    <!-- data source to integrate (PointCloud2) -->
    <remap from="cloud_in" to="/head_mount_kinect2/depth_registered/points" />

  </node>

  <node name="octomap_2D_server" pkg="octomap_server" type="octomap_2D_server" >
  	<param name="min_z_range" value="0.11" />
  	<param name="max_z_range" value="1.8" />
  	<param name="min_x_size" value="16.0" />
  	<param name="min_y_size" value="16.0" />
  </node>




  <node name="pr2_demo" pkg="pr2_py" type="pr2_demo.py" respawn="false" output="screen">
  </node>

</launch>
